// ТЕСТОВЫЙ КОД ДЛЯ ПРОВЕРКИ ДИСПЛЕЯ
// Временно переименуйте main.cpp в main.cpp.old
// И этот файл в test_display.cpp
// Затем загрузите прошивку

#include <Arduino.h>
#include <Adafruit_GFX.h>
#include <Adafruit_ST7735.h>
#include <SPI.h>

#define TFT_CS   5
#define TFT_RST  4
#define TFT_DC   2
#define TFT_SCLK 18
#define TFT_MOSI 23

Adafruit_ST7735 tft = Adafruit_ST7735(TFT_CS, TFT_DC, TFT_MOSI, TFT_SCLK, TFT_RST);

void testMode(const char* modeName, uint8_t mode) {
  Serial.println("=====================================");
  Serial.print("Testing mode: ");
  Serial.println(modeName);
  
  // Инициализация
  tft.initR(mode);
  delay(200);
  
  // Красный экран
  Serial.println("Setting RED screen...");
  tft.fillScreen(ST7735_RED);
  delay(2000);
  
  // Зеленый экран
  Serial.println("Setting GREEN screen...");
  tft.fillScreen(ST7735_GREEN);
  delay(2000);
  
  // Синий экран
  Serial.println("Setting BLUE screen...");
  tft.fillScreen(ST7735_BLUE);
  delay(2000);
  
  // Белый экран
  Serial.println("Setting WHITE screen...");
  tft.fillScreen(ST7735_WHITE);
  delay(2000);
  
  // Черный экран
  Serial.println("Setting BLACK screen...");
  tft.fillScreen(ST7735_BLACK);
  delay(1000);
  
  Serial.print("Mode ");
  Serial.print(modeName);
  Serial.println(" test complete!");
  Serial.println("If you saw colors, THIS MODE WORKS!");
  Serial.println("=====================================");
  delay(3000);
}

void setup() {
  Serial.begin(115200);
  delay(2000);
  Serial.println("\n\n===========================================");
  Serial.println("ST7735 Display Mode Tester");
  Serial.println("===========================================");
  Serial.println("Watch the display for color changes!");
  Serial.println("Red -> Green -> Blue -> White -> Black");
  Serial.println("===========================================\n");
  
  delay(2000);
}

void loop() {
  // Тестируем все режимы по очереди
  
  testMode("INITR_144GREENTAB (for 1.44\" displays)", INITR_144GREENTAB);
  testMode("INITR_BLACKTAB", INITR_BLACKTAB);
  testMode("INITR_REDTAB", INITR_REDTAB);
  testMode("INITR_GREENTAB", INITR_GREENTAB);
  
  Serial.println("\n\n===========================================");
  Serial.println("ALL MODES TESTED!");
  Serial.println("Which one showed colors on the display?");
  Serial.println("Update main.cpp with that mode!");
  Serial.println("===========================================\n");
  Serial.println("Restarting tests in 10 seconds...\n");
  
  delay(10000);
}